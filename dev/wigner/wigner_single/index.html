<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Single system state · CVsim.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">CVsim.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">CVsim.jl: Continuous variable quantum system simulation package</a></li><li><a class="tocitem" href="../../installation/">Installation</a></li><li><a class="tocitem" href="../../parameters/">CVsim Parameters</a></li><li><span class="tocitem">State preparation</span><ul><li><a class="tocitem" href="../../preparation/general/">General structure</a></li><li><a class="tocitem" href="../../preparation/GKP/">GKP states</a></li><li><a class="tocitem" href="../../preparation/Cat/">Cat states</a></li></ul></li><li><span class="tocitem">State stabilization</span><ul><li><a class="tocitem" href="../../stabilization/general/">General structure</a></li><li><a class="tocitem" href="../../stabilization/GKP/">GKP states</a></li></ul></li><li><span class="tocitem">Wigner quasiprobability</span><ul><li class="is-active"><a class="tocitem" href>Single system state</a></li><li><a class="tocitem" href="../wigner_joint/">Joint system state</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples_md/1-state-prep/">State preparation and visualization</a></li><li><a class="tocitem" href="../../examples_md/2-cz-gkp/">CZ gate between two GKP states</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Wigner quasiprobability</a></li><li class="is-active"><a href>Single system state</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Single system state</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/irojkov-ph/CVsim.jl/blob/main/docs/src/wigner/wigner_single.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="wigner_single"><a class="docs-heading-anchor" href="#wigner_single">Wigner quasiprobability of a single CV system state</a><a id="wigner_single-1"></a><a class="docs-heading-anchor-permalink" href="#wigner_single" title="Permalink"></a></h1><p>The <a href="https://en.wikipedia.org/wiki/Wigner_quasiprobability_distribution">Wigner quasiprobability</a> representation of a single continuous-variable (CV) system&#39;s state <span>$\rho$</span> is defined as</p><p class="math-container">\[  W(x,p)=\frac{1}{\pi\hbar}\int_{-\infty}^{+\infty} \,
  \exp\left(\frac{2i}{\hbar}\,p\,y\right) \,
  \langle x-y \vert \rho \vert x+y\rangle \,
  \mathrm{d}y \,.\]</p><p>It is evident that this representation is defined by the Fourier transform of the antidiagonals of the density matrix <span>$\rho$</span> expressed in the position basis. Since <code>CVsim.jl</code> relies on position or momentum representations of CV system states, we can obtain their Wigner quasiprobability through a fast Fourier transform of the columns of their &quot;skewed density matrix&quot;. The latter corresponds to the original position density matrix but skewed along one direction,</p><p class="math-container">\[  \begin{pmatrix}
  \cdot &amp; \cdot &amp; \cdot &amp; \cdot \\
  \cdot &amp; \cdot &amp; \cdot &amp; \cdot \\
  \cdot &amp; \cdot &amp; \cdot &amp; \cdot \\
  \cdot &amp; \cdot &amp; \cdot &amp; \cdot 
  \end{pmatrix} 
  \mapsto
  \begin{pmatrix}
  \cdot &amp; \cdot &amp; \cdot &amp; \cdot &amp; 0 &amp; 0 &amp; 0 \\
  0 &amp; \cdot &amp; \cdot &amp; \cdot &amp; \cdot &amp; 0 &amp; 0\\
  0 &amp; 0 &amp; \cdot &amp; \cdot &amp; \cdot &amp; \cdot &amp; 0\\
  0 &amp; 0 &amp; 0 &amp; \cdot &amp; \cdot &amp; \cdot &amp; \cdot 
\end{pmatrix} \]</p><p>Note that the first, third, fifth, etc. columns will contain the desired antidiagonal elements. The even columns will contain in-between antidiagonals and hold mostly redundant information. They could be included but that requires extra computation due to how they straddle across the diagonal. Selecting the odd columns and performing their FFT gives us the desired Wigner quasi-probability as a square matrix of the same dimension as <span>$\rho$</span>.</p><p>This calculation has been first implemented in Python by the Wikipedia user <a href="https://en.wikipedia.org/wiki/User:Nanite">Nanite</a> in their <a href="https://en.wikipedia.org/wiki/File:Hamiltonian_flow_quantum.webm">&quot;Long-time evolution of a mixed state ρ in an anharmonic  potential well.&quot;</a> simulation. We adapted it in Julia here.</p><article class="docstring"><header><a class="docstring-binding" id="CVsim.wignerify-Tuple{Matrix{ComplexF64}}" href="#CVsim.wignerify-Tuple{Matrix{ComplexF64}}"><code>CVsim.wignerify</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wignerify(mat)</code></pre><p>Compute the Wigner transform of position-basis density matrix which is  a Fourier transform of the anti-diagonals of the matrix (cf. Wikipedia).</p><p>Pad the matrix along one dimension, then skew the matrix. This converts the antidiagonals to straight columns.</p><pre><code class="nohighlight hljs">       |‾‾‾‾|          |‾‾‾‾000|
       |    |    --&gt;   |0    00|
       |    |          |00    0|
       |____|          |000____|</code></pre><p>Note that the first, third, fifth, etc. columns will contain the desired antidiagonal elements. The even columns will contain in-between antidiagonals. Here we are interested only in the former ones, i.e. the skew matrix is a square matrix of the same dimensions as the original density matrix in the  position basis.</p><p>This calculation has been first implemented in Python by the Wikipedia user  &quot;Nanite&quot; in their &quot;Long-time evolution of a mixed state ρ in an anharmonic  potential well.&quot; simulation and adapted in Julia here. src: https://en.wikipedia.org/wiki/File:Hamiltonian<em>flow</em>quantum.webm</p><p>Inputs:</p><ul><li><code>mat::Matrix{ComplexF64}</code> : Matrix representing an operator (density                              matrix) in a position basis.</li></ul><p>Output:</p><ul><li><code>Matrix{Float64}</code>         : Wigner transform of the matrix                              (same shape as <code>mat</code>).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/irojkov-ph/CVsim.jl/blob/7fe67f70b026b58d993ca79c5c4815d0e4b228fb/src/wignerify.jl#L3-L37">source</a></section></article><p>In <code>CVsim.jl</code>, we overload this function to enable seamless integration with <code>QuantumOptics.jl</code>, specifically <code>Operator</code> objects (representing density matrices) and <code>StateVector</code> objects (encompassing <code>Ket</code> and <code>Bra</code> states), all defined in a position basis.</p><article class="docstring"><header><a class="docstring-binding" id="CVsim.wignerify-Union{Tuple{Operator{B, B}}, Tuple{B}} where B&lt;:PositionBasis" href="#CVsim.wignerify-Union{Tuple{Operator{B, B}}, Tuple{B}} where B&lt;:PositionBasis"><code>CVsim.wignerify</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wignerify(rho)
wignerify(rho,indices)</code></pre><p>Compute the Wigner quasiprobability distribution for the given operator rho.</p><p>If its basis <code>B</code> is a single position basis it returns a single distribution.</p><p>If instead <code>B</code> is a composite basis then it will calculate the Wigner quasiprobability distribution for all the subsystems which have a position basis.</p><p>Inputs:</p><ul><li><code>rho::Operator{B,B}</code>        : Operator (density matrix) defined in                                the basis <code>B</code></li><li><code>indices::Vector{Int}</code>      : Indices of the subspaces for which you                               would like a Wigner quasiprobability</li></ul><p>Output:</p><ul><li>if <code>B == PositionBasis</code>:<ul><li><code>Matrix{Float64}</code>         : Wigner quasiprobability of dimension <code>n = length(B)</code></li></ul></li><li>if <code>B == CompositeBasis</code> or if indices are specified:<ul><li><code>Vector{Matrix{Float64}}</code> : Vector with Wigner quasiprobability of                             dimension <code>n_k = length(B_k)</code> where <code>B_k</code>                             is the position basis of a subspace of <code>B</code></li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/irojkov-ph/CVsim.jl/blob/7fe67f70b026b58d993ca79c5c4815d0e4b228fb/src/wignerify.jl#L74-L98">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="CVsim.wignerify-Union{Tuple{StateVector{B}}, Tuple{B}} where B&lt;:PositionBasis" href="#CVsim.wignerify-Union{Tuple{StateVector{B}}, Tuple{B}} where B&lt;:PositionBasis"><code>CVsim.wignerify</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wignerify(psi)
wignerify(psi,indices)</code></pre><p>Compute the Wigner quasiprobability distribution for the given state vector  (i.e. Ket or Bra). The function just transform the state vector to a density matrix and calculate the distribution.</p><p>Inputs:</p><ul><li><code>psi::StateVector{B}</code>       : State vector (Ket or Bra) defined in                                the basis <code>B</code></li><li><code>indices::Vector{Int}</code>      : Indices of the subspaces for which you                               would like a Wigner quasiprobability</li></ul><p>Output:</p><ul><li>if <code>B == PositionBasis</code>:<ul><li><code>Matrix{Float64}</code>         : Wigner quasiprobability of dimension <code>n = length(B)</code></li></ul></li><li>if <code>B == CompositeBasis</code> or if indices are specified:<ul><li><code>Vector{Matrix{Float64}}</code> : Vector with k Wigner quasiprobability of                             dimension <code>n_k = length(B_k)</code> where <code>B_k</code>                             is the position basis of a subspace of <code>B</code></li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/irojkov-ph/CVsim.jl/blob/7fe67f70b026b58d993ca79c5c4815d0e4b228fb/src/wignerify.jl#L143-L164">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../stabilization/GKP/">« GKP states</a><a class="docs-footer-nextpage" href="../wigner_joint/">Joint system state »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 29 July 2024 22:35">Monday 29 July 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
